{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <!--Import materialize.css-->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Font Awsome CDN -->
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
      integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm"
      crossorigin="anonymous"
    />
    <!-- Font Awesome Kit -->
    <script
      src="https://kit.fontawesome.com/aa5819adb1.js"
      crossorigin="anonymous"
    ></script>
    <!-- CSS Stylesheet -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  </head>
  <body>
    <!-- Nav Bar -->
    <header>
      <!-- Nav Bar -->
      <nav id="nav">
        <div class="nav-wrapper">
          <a href="/" class="brand-logo" id="home-text">Engage Fitness</a>
          <a href="#" data-target="mobile-demo" class="sidenav-trigger"
            ><i class="fas fa-bars"></i
          ></a>
          <ul class="right hide-on-med-and-down" id="nav-link">
            {% if user.is_authenticated %}
            <li><a href="/home">Work Outs</a></li>
            <li><a href="/availability">Book 1-1 Session</a></li>
            <li><a href="/#middle">What We Do</a></li>
            <li><a href="/#reviews">Reviews</a></li>
            <li><a href="/#socials">Socials</a></li>
            <li><a href="{% url 'account_logout' %}">Log Out</a></li>
            {% else %}
            <li><a href="{% url 'account_login' %}">Log In</a></li>
            <li><a href="{% url 'account_signup' %}">Sign Up</a></li>
            <li><a href="/#middle">What We Do</a></li>
            <li><a href="/#reviews">Reviews</a></li>
            <li><a href="/#socials">Socials</a></li>
            {% endif %}
          </ul>
        </div>
      </nav>

      <ul class="sidenav" id="mobile-demo">
        {% if user.is_authenticated %}
        <li><a href="/home">Work Outs</a></li>
        <li><a href="/availability">Book 1-1 Session</a></li>
        <li><a href="/#middle">What We Do</a></li>
        <li><a href="/#reviews">Reviews</a></li>
        <li><a href="/#socials">Socials</a></li>
        <li><a href="{% url 'account_logout' %}">Log Out</a></li>
        {% else %}
        <li><a href="{% url 'account_login' %}">Log In</a></li>
        <li><a href="{% url 'account_signup' %}">Sign Up</a></li>
        <li><a href="/#middle">What We Do</a></li>
        <li><a href="/#reviews">Reviews</a></li>
        <li><a href="/#socials">Socials</a></li>
        {% endif %}
      </ul>
    </header>
    {% block content %}
        {% if user.is_authenticated %}
        <h1 id="book-head">Book Your 1-2-1 Session</h1>
          <div id="appointment-area">
            <form class="form-book" action="" method="POST" id="datetimepicker1"> 
                {% csrf_token %}
                <label for="id_name">Name</label>
                <input type="text" name="name" maxlength="80" required_id="id_name" required>
                <label for="id_email">Email</label>
                <input type="email" required_id="id_email" name="email" max_length="254" required>
                <label for="id_start_date">Start Date & Time</label>
                <input type="text" name="start_date" required_id="id_start_date" placeholder="Select Date & Time" id="datetime" required/>
                <label for="id_end_date">End Date & Time</label>
                <input type="text" name="end_date" required_id="id_end_date" placeholder="Select Date & Time" class="datepicker" id="datetime2" required>
                <button class="btn btn-signup right" type="submit">Book</button>
            </form>
        </div>
        {% else %}
        <h1>Please Log In</h1>
        {% endif %}
    {% endblock content %}
    <!-- Social Media Area -->
    <footer id="socials">
      <h1>Socials</h1>
      <a
        href="https://www.instagram.com/"
        aria-label="link-to-instagram"
        target="_blank"
        ><i class="fab fa-instagram"></i
      ></a>
      <a
        href="https://en-gb.facebook.com/"
        aria-label="link-to-facebook"
        target="_blank"
        ><i class="fab fa-facebook-square"></i
      ></a>
      <a
        href="https://twitter.com/?lang=en"
        aria-label="link-to-twitter"
        target="_blank"
        ><i class="fab fa-twitter-square"></i
      ></a>
    </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="{% static 'js/index.js' %}"></script>
    <script>
       var MaterialDateTimePicker = {
        control: null,
        dateRange: null,
        pickerOptions: null,
        create: function (element) {
          this.control =
            element == undefined
              ? $("#" + localStorage.getItem("element"))
              : element;
          element = this.control;
          if (this.control.is("input[type='text']")) {
            var defaultDate = new Date();
            element.off("click");
            element.datepicker({
              format: "yyyy-mm-dd",
              disableWeekends: true,
              selectMonths: true,
              dismissable: false,
              autoClose: true,
              onClose: function () {
                element.datepicker("destroy");
                element.timepicker({
                  dismissable: false,
                  twelveHour: false,
                  onSelect: function (hr, min) {
                    element.attr("selectedTime", (hr + ":" + min).toString());
                  },
                  onCloseEnd: function () {
                    element.blur();
                  },
                });
                $("button.btn-flat.timepicker-close.waves-effect")[0].remove();

                if (element.val() != "") {
                  element.attr("selectedDate", element.val().toString());
                } else {
                  element.val(
                    defaultDate.getFullYear().toString() +
                      "/" +
                      (defaultDate.getMonth() + 1).toString() +
                      "/" +
                      defaultDate.getDate().toString()
                  );
                  element.attr("selectedDate", element.val().toString());
                }
                element.timepicker("open");
              },
            });
            element.unbind("change");
            element.off("change");
            element.on("change", function () {
              if (element.val().indexOf(":") > -1) {
                element.attr("selectedTime", element.val().toString());
                element.val(
                  element.attr("selectedDate") +
                    " " +
                    element.attr("selectedTime")
                );
                element.timepicker("destroy");
                element.unbind("click");
                element.off("click");
                element.on("click", function (e) {
                  element.val("");
                  element.removeAttr("selectedDate");
                  element.removeAttr("selectedTime");
                  localStorage.setItem("element", element.attr("id"));
                  MaterialDateTimePicker.create.call(element);
                  element.trigger("click");
                });
              }
            });
            $(
              "button.btn-flat.datepicker-cancel.waves-effect, button.btn-flat.datepicker-done.waves-effect"
            ).remove();
            this.addCSSRules();
            return element;
          } else {
            console.error(
              "The HTML Control provided is not a valid Input Text type."
            );
          }
        },
        addCSSRules: function () {
          $("html > head").append(
            $("<style>div.modal-overlay { pointer-events:none; }</style>")
          );
        },
      };
      $(document).ready(function () {
        M.AutoInit();
        var DateField = MaterialDateTimePicker.create($("#datetime"));
      });
      $(document).ready(function () {
        M.AutoInit();
        var DateField = MaterialDateTimePicker.create($("#datetime2"));
      });
    </script>
  </body>
</html>